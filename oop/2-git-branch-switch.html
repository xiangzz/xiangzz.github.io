<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Git åˆ†æ”¯åˆ›å»ºä¸åˆ‡æ¢æ¼”ç¤º</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Montserrat:wght@400;600;700&family=Georgia:wght@400&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Lato', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            line-height: 1.7;
            background-color: #fdfdfd;
            color: #4a4a4a;
            display: flex;
            justify-content: center;
            padding: 20px;
        }
        .container {
            width: 100%;
            max-width: 900px;
            background-color: #ffffff;
            border-radius: 4px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.07);
            border: 1px solid #e9ecef;
            padding: 30px;
        }
        
        /* æ ‡é¢˜å’ŒæŒ‰é’®å®¹å™¨ */
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        h1 {
            text-align: left;
            color: #2c3e50;
            font-family: 'Georgia', 'Times New Roman', Times, serif;
            font-size: 2.8rem;
            font-weight: normal;
            position: relative;
            padding-bottom: 1rem;
            margin: 0;
            flex: 1;
        }
        h1::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 80px;
            height: 2px;
            background-color: #af9a7d;
        }

        /* æ§åˆ¶å’ŒçŠ¶æ€åŒº */
        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        button {
            padding: 10px 20px;
            border: 1px solid #2c3e50;
            border-radius: 4px;
            background-color: #2c3e50;
            color: #ffffff;
            cursor: pointer;
            font-size: 14px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        button:hover {
            background-color: #af9a7d;
            border-color: #af9a7d;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        
        button:disabled {
            background-color: #bdc3c7;
            border-color: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        #next-step-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #next-step-btn:hover {
            background-color: #2980b9;
        }
        #next-step-btn:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        
        .status {
            background-color: #ecf0f1;
            border-left: 5px solid #3498db;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        #command-display {
            font-family: 'Courier New', Courier, monospace;
            background-color: #2c3e50;
            color: #f1c40f;
            padding: 10px;
            border-radius: 4px;
            white-space: pre-wrap;
        }
        
        #explanation {
            margin-top: 10px;
            color: #555;
        }

        /* Gitå›¾å½¢æ ·å¼ */
        .git-graph {
            background-color: #ffffff;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 30px;
            margin: 30px 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        /* å›¾å½¢åŒ–å±•ç¤ºåŒº */
        #graph-container {
            width: 100%;
            height: 300px;
            margin-bottom: 20px;
        }
        
        .commit-circle {
            transition: all 0.5s ease;
            cursor: pointer;
        }
        
        .commit-circle:hover {
            transform: scale(1.1);
        }
        
        .commit-label {
            font-family: 'Courier New', Courier, monospace;
            font-size: 12px;
        }
        
        .main-branch { stroke: #2ecc71; stroke-width: 4; }
        .test-branch { stroke: #e67e22; stroke-width: 4; }
        
        .branch-highlight {
            stroke-dasharray: 5,5;
            animation: dash 1s linear infinite;
        }
        
        @keyframes dash {
            to {
                stroke-dashoffset: -10;
            }
        }

        /* åˆ†æ”¯çŠ¶æ€æ˜¾ç¤º */
        .branch-status {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }
        
        .branch-info {
            flex: 1;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            background-color: #ffffff;
        }
        
        .branch-info h4 {
            margin-top: 0;
            color: #2c3e50;
            font-family: 'Montserrat', sans-serif;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .branch-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .main-indicator { background-color: #2ecc71; }
        .test-indicator { background-color: #e67e22; }
        
        .current-indicator {
            background-color: #e74c3c;
            animation: pulse 1.5s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* ä¿¡æ¯é¢æ¿ */
        #info-panel {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 20px;
            margin-top: 30px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            white-space: pre-wrap;
            color: #4a4a4a;
            line-height: 1.6;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .controls {
                align-self: stretch;
                justify-content: center;
            }
            
            .branch-status {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header-container">
        <h1>Git åˆ†æ”¯åˆ›å»ºä¸åˆ‡æ¢æ¼”ç¤º</h1>
        <div class="controls">
            <button id="next-step-btn">å¼€å§‹æ¼”ç¤º</button>
        </div>
    </div>

    <div class="status">
        <pre id="command-display">ç­‰å¾…æ“ä½œ...</pre>
        <p id="explanation">ç‚¹å‡»"å¼€å§‹æ¼”ç¤º"æŒ‰é’®ï¼Œä¸€æ­¥æ­¥è·Ÿéš Git åˆ†æ”¯åˆ›å»ºå’Œåˆ‡æ¢çš„æ“ä½œæµç¨‹ã€‚</p>
    </div>

    <div id="graph-container">
        <svg width="100%" height="100%" id="git-graph"></svg>
    </div>

    <div class="branch-status">
        <div class="branch-info">
            <h4><span class="branch-indicator main-indicator"></span>main åˆ†æ”¯</h4>
            <p id="main-status">å½“å‰åˆ†æ”¯ï¼ŒåŒ…å«é¡¹ç›®çš„ä¸»è¦ä»£ç </p>
        </div>
        <div class="branch-info">
            <h4><span class="branch-indicator test-indicator"></span>test åˆ†æ”¯</h4>
            <p id="test-status">å°šæœªåˆ›å»º</p>
        </div>
    </div>

    <div id="info-panel"></div>
</div>

<script>
    const steps = [
        {
            command: "git init",
            explanation: "åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ Git ä»“åº“ã€‚åˆ›å»ºç¬¬ä¸€ä¸ªæäº¤ï¼ŒHEAD æŒ‡å‘ main åˆ†æ”¯ã€‚",
            action: () => {
                drawCommit('c1', 100, 150, 'C1', 'main');
                drawBranchLabel('main', 100, 120);
                drawHeadPointer('main');
                updateBranchStatus('main', 'å½“å‰åˆ†æ”¯ (HEAD)ï¼ŒåŒ…å«åˆå§‹æäº¤');
                updateInfoPanel('åˆå§‹åŒ–ä»“åº“å®Œæˆã€‚HEAD æŒ‡é’ˆæŒ‡å‘ main åˆ†æ”¯çš„ç¬¬ä¸€ä¸ªæäº¤ã€‚');
            }
        },
        {
            command: "git commit -m 'feat: æ·»åŠ åŸºç¡€åŠŸèƒ½'",
            explanation: "åœ¨ main åˆ†æ”¯ä¸Šæ·»åŠ ç¬¬äºŒä¸ªæäº¤ã€‚HEAD æŒ‡é’ˆè·Ÿéš main åˆ†æ”¯ç§»åŠ¨ã€‚",
            action: () => {
                drawCommit('c2', 200, 150, 'C2', 'main');
                drawLine('c1', 'c2', 'main');
                moveBranchLabel('main', 200, 120);
                moveHeadPointer('main');
                updateBranchStatus('main', 'å½“å‰åˆ†æ”¯ (HEAD)ï¼ŒåŒ…å« 2 ä¸ªæäº¤');
                updateInfoPanel('åœ¨ main åˆ†æ”¯ä¸Šæ·»åŠ æ–°æäº¤ã€‚HEAD æŒ‡é’ˆè‡ªåŠ¨è·Ÿéšåˆ†æ”¯ç§»åŠ¨åˆ°æœ€æ–°æäº¤ã€‚');
            }
        },
        {
            command: "git commit -m 'feat: å®Œå–„åŠŸèƒ½'",
            explanation: "ç»§ç»­åœ¨ main åˆ†æ”¯ä¸Šå¼€å‘ï¼Œæ·»åŠ ç¬¬ä¸‰ä¸ªæäº¤ã€‚",
            action: () => {
                drawCommit('c3', 300, 150, 'C3', 'main');
                drawLine('c2', 'c3', 'main');
                moveBranchLabel('main', 300, 120);
                moveHeadPointer('main');
                updateBranchStatus('main', 'å½“å‰åˆ†æ”¯ (HEAD)ï¼ŒåŒ…å« 3 ä¸ªæäº¤');
                updateInfoPanel('ç»§ç»­åœ¨ main åˆ†æ”¯å¼€å‘ã€‚æ³¨æ„ HEAD æŒ‡é’ˆå§‹ç»ˆæŒ‡å‘å½“å‰åˆ†æ”¯çš„æœ€æ–°æäº¤ã€‚');
            }
        },
        {
            command: "git branch test",
            explanation: "åŸºäºå½“å‰ main åˆ†æ”¯çš„æœ€æ–°æäº¤(C3)åˆ›å»ºä¸€ä¸ªæ–°çš„ test åˆ†æ”¯ã€‚æ³¨æ„ï¼šHEAD ä»ç„¶æŒ‡å‘ mainã€‚",
            action: () => {
                drawBranchLabel('test', 300, 90);
                updateBranchStatus('test', 'æ–°åˆ›å»ºçš„åˆ†æ”¯ï¼ŒåŸºäº C3 æäº¤');
                updateInfoPanel('åˆ›å»º test åˆ†æ”¯æˆåŠŸï¼æ–°åˆ†æ”¯æŒ‡å‘ä¸ main ç›¸åŒçš„æäº¤(C3)ã€‚\næ³¨æ„ï¼šHEAD æŒ‡é’ˆä»ç„¶æŒ‡å‘ main åˆ†æ”¯ï¼Œæˆ‘ä»¬è¿˜åœ¨ main åˆ†æ”¯ä¸Šå·¥ä½œã€‚');
            }
        },
        {
            command: "git branch",
            explanation: "æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ã€‚* å·è¡¨ç¤ºå½“å‰æ‰€åœ¨çš„åˆ†æ”¯(main)ã€‚",
            action: () => {
                updateInfoPanel('åˆ†æ”¯åˆ—è¡¨ï¼š\n* main    (å½“å‰åˆ†æ”¯ï¼ŒHEAD æŒ‡å‘è¿™é‡Œ)\n  test    (æ–°åˆ›å»ºçš„åˆ†æ”¯)\n\næ˜Ÿå·(*)è¡¨ç¤ºå½“å‰æ‰€åœ¨åˆ†æ”¯ã€‚');
            }
        },
        {
            command: "git checkout test",
            explanation: "åˆ‡æ¢åˆ° test åˆ†æ”¯ã€‚è¿™æ˜¯å…³é”®æ—¶åˆ»ï¼šHEAD æŒ‡é’ˆä» main ç§»åŠ¨åˆ° testï¼",
            action: () => {
                moveHeadPointer('test');
                updateBranchStatus('main', 'åŒ…å« 3 ä¸ªæäº¤');
                updateBranchStatus('test', 'å½“å‰åˆ†æ”¯ (HEAD)ï¼ŒåŒ…å« 3 ä¸ªæäº¤');
                updateInfoPanel('åˆ‡æ¢åˆ° test åˆ†æ”¯ï¼\n\né‡è¦å˜åŒ–ï¼š\n- HEAD æŒ‡é’ˆä» main ç§»åŠ¨åˆ° test\n- ç°åœ¨æˆ‘ä»¬åœ¨ test åˆ†æ”¯ä¸Šå·¥ä½œ\n- å·¥ä½œç›®å½•å†…å®¹ä¿æŒä¸å˜(éƒ½æŒ‡å‘ C3)');
            }
        },
        {
            command: "git commit -m 'test: æ·»åŠ æµ‹è¯•åŠŸèƒ½'",
            explanation: "åœ¨ test åˆ†æ”¯ä¸Šè¿›è¡Œæäº¤ã€‚ç°åœ¨ä¸¤ä¸ªåˆ†æ”¯å¼€å§‹åˆ†å‰ï¼",
            action: () => {
                drawCommit('c4', 400, 180, 'C4', 'test');
                drawLine('c3', 'c4', 'test');
                moveBranchLabel('test', 400, 90);
                moveHeadPointer('test');
                updateBranchStatus('test', 'å½“å‰åˆ†æ”¯ (HEAD)ï¼ŒåŒ…å« 4 ä¸ªæäº¤');
                updateInfoPanel('åœ¨ test åˆ†æ”¯ä¸Šæ·»åŠ æ–°æäº¤ï¼\n\nç°åœ¨ï¼š\n- test åˆ†æ”¯æŒ‡å‘ C4(æœ€æ–°)\n- main åˆ†æ”¯ä»æŒ‡å‘ C3\n- HEAD è·Ÿéš test åˆ†æ”¯ç§»åŠ¨\n- ä¸¤ä¸ªåˆ†æ”¯å¼€å§‹åˆ†å‰');
            }
        },
        {
            command: "git commit -m 'test: å®Œå–„æµ‹è¯•'",
            explanation: "ç»§ç»­åœ¨ test åˆ†æ”¯ä¸Šå¼€å‘ã€‚test åˆ†æ”¯ç°åœ¨é¢†å…ˆ main åˆ†æ”¯ä¸¤ä¸ªæäº¤ã€‚",
            action: () => {
                drawCommit('c5', 500, 180, 'C5', 'test');
                drawLine('c4', 'c5', 'test');
                moveBranchLabel('test', 500, 90);
                moveHeadPointer('test');
                updateBranchStatus('test', 'å½“å‰åˆ†æ”¯ (HEAD)ï¼ŒåŒ…å« 5 ä¸ªæäº¤');
                updateInfoPanel('ç»§ç»­åœ¨ test åˆ†æ”¯å¼€å‘ã€‚\n\ntest åˆ†æ”¯ç°åœ¨é¢†å…ˆ main åˆ†æ”¯ 2 ä¸ªæäº¤ï¼š\n- test: C1 â†’ C2 â†’ C3 â†’ C4 â†’ C5\n- main: C1 â†’ C2 â†’ C3');
            }
        },
        {
            command: "git checkout main",
            explanation: "åˆ‡æ¢å› main åˆ†æ”¯ã€‚è§‚å¯Ÿ HEAD æŒ‡é’ˆçš„ç§»åŠ¨ï¼",
            action: () => {
                moveHeadPointer('main');
                updateBranchStatus('main', 'å½“å‰åˆ†æ”¯ (HEAD)ï¼ŒåŒ…å« 3 ä¸ªæäº¤');
                updateBranchStatus('test', 'åŒ…å« 5 ä¸ªæäº¤');
                updateInfoPanel('åˆ‡æ¢å› main åˆ†æ”¯ï¼\n\né‡è¦å˜åŒ–ï¼š\n- HEAD æŒ‡é’ˆä» test ç§»å› main\n- å·¥ä½œç›®å½•æ¢å¤åˆ° main åˆ†æ”¯çš„çŠ¶æ€(C3)\n- test åˆ†æ”¯çš„æ›´æ”¹(C4, C5)æš‚æ—¶"çœ‹ä¸è§"äº†');
            }
        },
        {
            command: "git branch",
            explanation: "å†æ¬¡æŸ¥çœ‹åˆ†æ”¯çŠ¶æ€ã€‚ç°åœ¨ * å·æŒ‡å‘ mainï¼Œç¡®è®¤æˆ‘ä»¬å·²ç»åˆ‡æ¢å›æ¥ã€‚",
            action: () => {
                updateInfoPanel('å½“å‰åˆ†æ”¯çŠ¶æ€ï¼š\n* main    (å½“å‰åˆ†æ”¯ï¼ŒHEAD æŒ‡å‘è¿™é‡Œ)\n  test    (åŒ…å«é¢å¤–çš„æäº¤)\n\nè¿™å°±æ˜¯ Git åˆ†æ”¯çš„å¼ºå¤§ä¹‹å¤„ï¼š\n- å¯ä»¥åœ¨ä¸åŒåˆ†æ”¯é—´è‡ªç”±åˆ‡æ¢\n- æ¯ä¸ªåˆ†æ”¯ç»´æŠ¤ç‹¬ç«‹çš„å¼€å‘å†å²\n- HEAD æŒ‡é’ˆå†³å®šå½“å‰å·¥ä½œç¯å¢ƒ');
            }
        },
        {
            command: "æ¼”ç¤ºå®Œæˆ",
            explanation: "åˆ†æ”¯åˆ›å»ºå’Œåˆ‡æ¢æ¼”ç¤ºå®Œæˆï¼ä½ å·²ç»å­¦ä¼šäº† Git åˆ†æ”¯çš„åŸºæœ¬æ“ä½œå’Œ HEAD æŒ‡é’ˆçš„å·¥ä½œåŸç†ã€‚",
            action: () => {
                updateInfoPanel('ğŸ‰ æ¼”ç¤ºå®Œæˆï¼\n\nä½ å­¦åˆ°äº†ï¼š\nâœ“ git branch <name> - åˆ›å»ºæ–°åˆ†æ”¯\nâœ“ git checkout <name> - åˆ‡æ¢åˆ†æ”¯\nâœ“ git branch - æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯\nâœ“ HEAD æŒ‡é’ˆçš„ä½œç”¨å’Œç§»åŠ¨è§„å¾‹\nâœ“ åˆ†æ”¯ç‹¬ç«‹å¼€å‘çš„æ¦‚å¿µ\n\nä¸‹ä¸€æ­¥å¯ä»¥å­¦ä¹ åˆ†æ”¯åˆå¹¶(merge)å’Œå˜åŸº(rebase)æ“ä½œï¼');
                document.getElementById('next-step-btn').innerText = "é‡æ–°å¼€å§‹";
            }
        }
    ];

    let currentStep = -1;
    const btn = document.getElementById('next-step-btn');
    const commandDisplay = document.getElementById('command-display');
    const explanationDisplay = document.getElementById('explanation');
    const svg = document.getElementById('git-graph');
    const infoPanel = document.getElementById('info-panel');
    const ns = "http://www.w3.org/2000/svg";

    const commitElements = {};
    const branchElements = {};
    let headElement = null;

    function reset() {
        currentStep = -1;
        svg.innerHTML = '';
        Object.keys(commitElements).forEach(key => delete commitElements[key]);
        Object.keys(branchElements).forEach(key => delete branchElements[key]);
        headElement = null;
        commandDisplay.innerText = "ç­‰å¾…æ“ä½œ...";
        explanationDisplay.innerText = "ç‚¹å‡»\"å¼€å§‹æ¼”ç¤º\"æŒ‰é’®ï¼Œä¸€æ­¥æ­¥è·Ÿéš Git åˆ†æ”¯åˆ›å»ºå’Œåˆ‡æ¢çš„æ“ä½œæµç¨‹ã€‚";
        btn.innerText = "å¼€å§‹æ¼”ç¤º";
        btn.disabled = false;
        updateBranchStatus('main', 'å½“å‰åˆ†æ”¯ï¼ŒåŒ…å«é¡¹ç›®çš„ä¸»è¦ä»£ç ');
        updateBranchStatus('test', 'å°šæœªåˆ›å»º');
        infoPanel.innerText = '';
    }

    function drawCommit(id, x, y, label, branch) {
        const circle = document.createElementNS(ns, 'circle');
        circle.setAttribute('cx', x);
        circle.setAttribute('cy', y);
        circle.setAttribute('r', 8);
        circle.setAttribute('fill', branch === 'main' ? '#2ecc71' : '#e67e22');
        circle.setAttribute('stroke', '#ffffff');
        circle.setAttribute('stroke-width', 3);
        circle.classList.add('commit-circle');
        svg.appendChild(circle);

        const text = document.createElementNS(ns, 'text');
        text.setAttribute('x', x);
        text.setAttribute('y', y + 25);
        text.setAttribute('text-anchor', 'middle');
        text.setAttribute('font-family', 'Courier New, monospace');
        text.setAttribute('font-size', '12');
        text.setAttribute('fill', '#4a4a4a');
        text.textContent = label;
        svg.appendChild(text);

        commitElements[id] = { circle, text, x, y };
    }

    function drawLine(fromId, toId, branch) {
        const from = commitElements[fromId];
        const to = commitElements[toId];
        
        const line = document.createElementNS(ns, 'line');
        line.setAttribute('x1', from.x);
        line.setAttribute('y1', from.y);
        line.setAttribute('x2', to.x);
        line.setAttribute('y2', to.y);
        line.setAttribute('stroke', branch === 'main' ? '#2ecc71' : '#e67e22');
        line.setAttribute('stroke-width', 4);
        line.setAttribute('stroke-linecap', 'round');
        svg.appendChild(line);
    }

    function drawBranchLabel(branchName, x, y) {
        const rect = document.createElementNS(ns, 'rect');
        rect.setAttribute('x', x - 20);
        rect.setAttribute('y', y - 10);
        rect.setAttribute('width', 40);
        rect.setAttribute('height', 20);
        rect.setAttribute('fill', branchName === 'main' ? '#2ecc71' : '#e67e22');
        rect.setAttribute('stroke', '#ffffff');
        rect.setAttribute('stroke-width', 2);
        rect.setAttribute('rx', 4);
        svg.appendChild(rect);

        const text = document.createElementNS(ns, 'text');
        text.setAttribute('x', x);
        text.setAttribute('y', y + 4);
        text.setAttribute('text-anchor', 'middle');
        text.setAttribute('font-family', 'Montserrat, sans-serif');
        text.setAttribute('font-size', '11');
        text.setAttribute('font-weight', '600');
        text.setAttribute('fill', '#ffffff');
        text.textContent = branchName;
        svg.appendChild(text);

        branchElements[branchName] = { rect, text, x, y };
    }

    function moveBranchLabel(branchName, newX, newY) {
        const element = branchElements[branchName];
        if (element) {
            element.rect.setAttribute('x', newX - 20);
            element.rect.setAttribute('y', newY - 10);
            element.text.setAttribute('x', newX);
            element.text.setAttribute('y', newY + 4);
            element.x = newX;
            element.y = newY;
        }
    }

    function drawHeadPointer(branchName) {
        if (headElement) {
            svg.removeChild(headElement.rect);
            svg.removeChild(headElement.text);
        }

        const branch = branchElements[branchName];
        if (branch) {
            const rect = document.createElementNS(ns, 'rect');
            rect.setAttribute('x', branch.x + 25);
            rect.setAttribute('y', branch.y - 8);
            rect.setAttribute('width', 35);
            rect.setAttribute('height', 16);
            rect.setAttribute('fill', '#e74c3c');
            rect.setAttribute('stroke', '#c0392b');
            rect.setAttribute('stroke-width', 2);
            rect.setAttribute('rx', 4);
            svg.appendChild(rect);

            const text = document.createElementNS(ns, 'text');
            text.setAttribute('x', branch.x + 42);
            text.setAttribute('y', branch.y + 3);
            text.setAttribute('text-anchor', 'middle');
            text.setAttribute('font-family', 'Montserrat, sans-serif');
            text.setAttribute('font-size', '10');
            text.setAttribute('font-weight', '700');
            text.setAttribute('fill', '#ffffff');
            text.textContent = 'HEAD';
            svg.appendChild(text);

            headElement = { rect, text, branch: branchName };
        }
    }

    function moveHeadPointer(branchName) {
        if (headElement) {
            const branch = branchElements[branchName];
            if (branch) {
                // æ·»åŠ åŠ¨ç”»æ•ˆæœ
                headElement.rect.style.transition = 'all 0.5s ease';
                headElement.text.style.transition = 'all 0.5s ease';
                
                headElement.rect.setAttribute('x', branch.x + 25);
                headElement.rect.setAttribute('y', branch.y - 8);
                headElement.text.setAttribute('x', branch.x + 42);
                headElement.text.setAttribute('y', branch.y + 3);
                headElement.branch = branchName;
            }
        }
    }

    function updateBranchStatus(branchName, status) {
        const statusElement = document.getElementById(branchName + '-status');
        if (statusElement) {
            statusElement.textContent = status;
        }
        
        // æ›´æ–°æŒ‡ç¤ºå™¨
        const indicators = document.querySelectorAll('.branch-indicator');
        indicators.forEach(indicator => {
            indicator.classList.remove('current-indicator');
        });
        
        if (status.includes('HEAD')) {
            const currentIndicator = document.querySelector('.' + branchName + '-indicator');
            if (currentIndicator) {
                currentIndicator.classList.add('current-indicator');
            }
        }
    }

    function updateInfoPanel(message) {
        infoPanel.textContent = message;
    }

    btn.addEventListener('click', () => {
        currentStep++;
        if (currentStep >= steps.length) {
            reset();
            return;
        }

        const step = steps[currentStep];
        commandDisplay.innerText = step.command;
        explanationDisplay.innerText = step.explanation;
        
        if (step.action) {
            step.action();
        }

        if (currentStep === steps.length - 1) {
            btn.innerText = "é‡æ–°å¼€å§‹";
        } else {
            btn.innerText = "ä¸‹ä¸€æ­¥";
        }
    });

    // åˆå§‹åŒ–
    reset();
</script>

</body>
</html>